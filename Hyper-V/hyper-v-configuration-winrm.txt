Hyper-V ‚Äì Configuration de la gestion √† distance via WinRM
Environnement : Workgroup (hors domaine Active Directory)
Derni√®re mise √† jour : 11 septembre 2025

üîπ CONFIGURATION du SERVEUR HYPER-V:
Un listener WinRM est un composant en √©coute sur un port r√©seau (par d√©faut 5985 pour HTTP ou 5986 pour HTTPS) en attente de connexions entrantes; 
Il est indispensable c√¥t√© serveur pour permettre la gestion √† distance via PowerShell ou Hyper-V Manager.
Il n‚Äôest pas n√©cessaire c√¥t√© client, le client initie les connexions.

La communication √† distance PowerShell est activ√©e par d√©faut sur les plateformes Windows Server.

V√©rification: 
winrm get winrm/config

Il est n√©cessaire d‚Äôactiver l‚Äôauthentification par d√©l√©gation d‚Äôauthentifiants (Credential Security Support Provider - CredSSP).

Configuration: 
Enable-WSManCredSSP -Role Server -Force

üîπ CONFIGURATION du POSTE CLIENT:
Activation des communications √† distance en PowerShell: 
Enable-PSRemoting

Activation de l‚Äôauthentification CredSSP et ajout du serveur aux h√¥tes de confiance: 
Enable-WSManCredSSP -Role Client -DelegateComputer <FQDN du SERVEUR> 
Set-Item WSMan:\localhost\Client\TrustedHosts -Value <FQDN du SERVEUR>

Test de connexion vers le listener: 
Test-NetConnection -ComputerName NOM_SERVEUR -Port 5985 (HTTP)

üîπ CONFIGURATION du GESTIONNAIRE HYPER-V
V√©rification de fonctionnalit√© Hyper-V (Gestionnaire Hyper-V):
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-Management-Clients

Configuration de la strat√©gie locale d‚Äôidentification:
gpedit.msc > Configuration de l‚Äôordinateur > Mod√®les d‚Äôadministration > Syst√®me > 
D√©l√©gation d‚Äôinformations d‚Äôidentification > 
"Autoriser les nouvelles informations d‚Äôidentification avec l‚Äôauthentification du serveur NTLM uniquement"

cli: Voir script "local-group-policy.ps1"


Liens:
https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/
https://learn.microsoft.com/en-us/windows/win32/winrm/portal
https://techcommunity.microsoft.com/blog/askperf/an-introduction-to-winrm-basics/374770
https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/manage/remotely-manage-hyper-v-hosts
https://learn.microsoft.com/en-us/troubleshoot/windows-server/virtualization/hyper-v-cluster-connectivity-management-configuration
